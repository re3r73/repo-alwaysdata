name: Déploiement sur alwaysdata

on:
  push:
    branches: [ main ] # Branche à surveiller

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Récupérer le code
        uses: actions/checkout@v4

      - name: Déployer via SSH
        uses: appleboy/scp-action@v0.1.4
        with:
          host: ssh-<votre_identifiant>.alwaysdata.net
          username: <votre_utilisateur_alwaysdata>
          password: ${{ secrets.ALWAYSDATA_PASSWORD }} # Stockez le mot de passe dans les secrets GitHub
          port: 22
          source: "." # Dossier local à copier
          target: "/home/<votre_identifiant>/www/" # Dossier cible sur alwaysdata

      # Optionnel : Exécuter des commandes post-déploiement (ex: installer des dépendances)
      - name: Exécuter des commandes SSH
        uses: appleboy/ssh-action@v1
        with:
          host: ssh-<votre_identifiant>.alwaysdata.net
          username: <votre_utilisateur_alwaysdata>
          password: ${{ secrets.ALWAYSDATA_PASSWORD }}
          port: 22
          script: |
            cd /home/<votre_identifiant>/www/
            # Exemple : composer install, npm install, etc.
